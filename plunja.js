var TemplateRegistry=function(e){function n(e){var n=0,t;if(0===e.length)return n;for(var r=0,o=e.length;o>r;r++)t=e.charCodeAt(r),n=(n<<5)-n+t,n|=0;return n}function t(e,n){return{name:e,resolve:function(r){var o,f,i,u,d,a,c;if("undefined"==typeof r&&(r={}),o=e.indexOf("."),o>-1)return f=e.substr(o+1),c=r[e.substr(0,o)],new t(f,n).resolve(c);if(i=e.indexOf("|"),i>-1){if(u=n.filters[e.substr(i+1)],"undefined"==typeof u)throw"Filter "+e.substr(i+1)+" not found";return d=r[e.substr(0,i)],"undefined"!=typeof d?u(d):("undefined"!=typeof console&&"undefined"!=typeof console.warn&&console.warn("Variable",e,"not found"),"")}return a=r[e],"undefined"!=typeof a?a:("undefined"!=typeof console&&"undefined"!=typeof console.warn&&console.warn("Variable",e,"not found"),"")}}}function r(e,t){function r(n,r,f){function u(){r(f(new o(n,t).parse(d._html.toString())))}"function"!=typeof f&&(f=function(e){var n=document.createDocumentFragment(),t=document.createElement("div");for(t.innerHTML=e;t.firstChild;)n.appendChild(t.firstChild);return n}),"undefined"!=typeof d._html?u():i.locator(e,function(n){if("boolean"==typeof n&&!n)throw"Template "+e+" not found";d._html=n,u()})}function f(e,n){if("undefined"!=typeof u[e])for(var t in u[e])u[e][t](n)}var u={},d={render:function(e,n){return r(e,function(e){f("render",e)},n),d},renderTo:function(e,n,t){return r(n,function(n){e.replaceChild(n),f("render",n)},t),d},appendTo:function(e,n,t){return r(n,function(n){e.appendChild(n),f("render",n)},t),d},on:function(e,t){"undefined"==typeof u[e]&&(u[e]={});var r=n(t.toString());return"undefined"==typeof u[e][r]&&(u[e][r]=t),d},off:function(e,t){if("undefined"==typeof t)u[e]={};else if("undefined"!=typeof u[e]){var r={},o=n(t.toString());for(var f in u[e])f!==o&&(r[f]=u[e][f]);u[e]=r}return d}};return d}function o(e,n){return"undefined"==typeof e&&(e={}),{parse:function(r){for(var o=new RegExp("\\{{2} ?([^\\{\\} ]+) ?\\}{2}"),f=new RegExp("\\{% ?([^% ]+)((?: )[^%]+)? ?%\\}"),i=r.match(f),u={},d,a,c,l,s,p,g,h,y,w;i&&i.length>1;){if(d=i[1],a=i[2],d=n.tags[d],"undefined"==typeof d)throw"Tag "+i[1]+" not found";if("undefined"!=typeof d.endtag){if(c=new RegExp("(\\{% ?"+d.endtag+" ?%\\}).*"),l=r.match(c),!l||0===l.length)throw"Tag "+i[1]+" found, but no "+d.endtag+" found";for(;l&&l.length>0;){s=l[l.length-1],h=r.indexOf(i[0])+i[0].length,y=r.lastIndexOf(s)-h,w=r.substr(h,y),r=r.replace(i[0]+w+s,d.handler(n,e,a,w));break}}else r=r.replace(f,d(a,r));break}for(i=r.match(o);i&&i.length>1;)p=i[1],"undefined"==typeof u[p]&&(u[p]=new t(p,n)),g=u[p].resolve(e),r=r.replace(o,g),i=r.match(o);return r}}}var f={locator:function(e,n){if("undefined"!=typeof jQuery){var t=jQuery('script[data-template="'+e+'"]');return t.length>0?void n(t.html()):void n(!1)}throw"Locator not defined"},filters:{uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()}},tags:{urlencode:{endtag:"endurlencode",handler:function(e,n,t,r){return escape(new o(n,e).parse(r.toString()))}},"for":{endtag:"endfor",handler:function(e,n,r,f){var i=new RegExp(/^(\w+) in ([\w\.]+)$/),u=r.trim().match(i),d,a,c,l=[];if(u&&u.length>2){if(d=u[1],a=new t(u[2],e).resolve(n),"undefined"==typeof a)return"";if(a&&a.length){c={};for(var s in n)c[s]=n[s];for(var p=0;p<a.length;p++)c[d]=a[p],l.push(new o(c,e).parse(f.toString()))}return l.join("")}throw"Syntax error in for tag"}}}},i={},u={};if(function(){for(var e in f)i[e]=f[e]}(),"objects"==typeof e)for(var d in e){var a;switch(d){case"filters":for(a in e.filters)i.filters[a]=e.filters[a];break;case"tags":for(a in e.tags)i.tags[a]=e.tags[a];break;default:if("undefined"==typeof f[d]&&"undefined"!=typeof console&&"undefined"!=typeof console.warn){console.warn("Unrecognised TemplateRegistry option",d);continue}i[d]=e[d]}}return i.get=function(e){return"undefined"==typeof u[e]&&(u[e]=new r(e,i)),u[e]},i};
